<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tennis Hitter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #1a472a 0%, #0d260f 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }
        #gameContainer {
            position: relative;
        }
        canvas {
            display: block;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(255, 255, 0, 0.3);
        }
        #ui {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            color: #fff;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            pointer-events: none;
        }
        #startScreen, #gameOver {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(0, 0, 0, 0.85);
            border-radius: 10px;
            color: #fff;
            text-align: center;
        }
        h1 {
            font-size: 48px;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #c8ff00, #00ff00, #ffff00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        h2 {
            font-size: 36px;
            margin-bottom: 15px;
            color: #c8ff00;
        }
        p {
            font-size: 18px;
            margin-bottom: 10px;
            color: #aaa;
        }
        .winner {
            font-size: 28px;
            color: #ffff00;
            margin: 20px 0;
        }
        button {
            padding: 15px 40px;
            font-size: 20px;
            margin: 10px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            background: linear-gradient(45deg, #c8ff00, #88cc00);
            color: #000;
            font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(200, 255, 0, 0.5);
        }
        .controls {
            margin-top: 20px;
            font-size: 16px;
            color: #888;
        }
        .difficulty {
            margin: 20px 0;
        }
        .difficulty button {
            padding: 10px 25px;
            font-size: 16px;
        }
        .difficulty button.selected {
            background: linear-gradient(45deg, #ffff00, #ffcc00);
            box-shadow: 0 0 15px rgba(255, 255, 0, 0.5);
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas" width="800" height="500"></canvas>
        <div id="ui">
            <span id="scoreDisplay">0 - 0</span>
        </div>

        <div id="startScreen">
            <h1>Tennis Hitter</h1>
            <p>First to 11 points wins!</p>
            <div class="controls">
                <p>Arrow Up/Down - Move</p>
                <p>Space - Serve / Power Hit</p>
            </div>
            <div class="difficulty">
                <p>Select Difficulty:</p>
                <button id="easyBtn" onclick="setDifficulty('easy')">Easy</button>
                <button id="mediumBtn" class="selected" onclick="setDifficulty('medium')">Medium</button>
                <button id="hardBtn" onclick="setDifficulty('hard')">Hard</button>
            </div>
            <button onclick="startGame()">Play Tennis!</button>
        </div>

        <div id="gameOver" style="display: none;">
            <h2>Game Over!</h2>
            <div class="winner" id="winnerText"></div>
            <p id="finalScoreText"></p>
            <button onclick="startGame()">Play Again</button>
            <button onclick="backToMenu()">Main Menu</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Game constants
        const COURT_COLOR = '#2d5a27';
        const LINE_COLOR = '#ffffff';
        const PADDLE_WIDTH = 15;
        const PADDLE_HEIGHT = 80;
        const BALL_SIZE = 12;
        const WIN_SCORE = 11;

        // Game state
        let player = {
            x: 30,
            y: canvas.height / 2 - PADDLE_HEIGHT / 2,
            score: 0,
            speed: 8
        };

        let opponent = {
            x: canvas.width - 30 - PADDLE_WIDTH,
            y: canvas.height / 2 - PADDLE_HEIGHT / 2,
            score: 0,
            speed: 5
        };

        let ball = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            vx: 0,
            vy: 0,
            speed: 7,
            serving: true,
            serverIsPlayer: true
        };

        let particles = [];
        let gameRunning = false;
        let difficulty = 'medium';
        let rallyCount = 0;

        // Input
        const keys = {};

        document.addEventListener('keydown', (e) => {
            keys[e.code] = true;
            if (e.code === 'Space') {
                e.preventDefault();
                if (ball.serving && ball.serverIsPlayer) {
                    serveBall();
                }
            }
        });

        document.addEventListener('keyup', (e) => {
            keys[e.code] = false;
        });

        function setDifficulty(diff) {
            difficulty = diff;
            document.querySelectorAll('.difficulty button').forEach(btn => btn.classList.remove('selected'));
            document.getElementById(diff + 'Btn').classList.add('selected');
        }

        function serveBall() {
            if (!ball.serving) return;

            ball.serving = false;
            rallyCount = 0;

            if (ball.serverIsPlayer) {
                ball.vx = ball.speed;
                ball.vy = (Math.random() - 0.5) * 6;
            } else {
                ball.vx = -ball.speed;
                ball.vy = (Math.random() - 0.5) * 6;
            }

            // Serve particles
            for (let i = 0; i < 10; i++) {
                particles.push({
                    x: ball.x,
                    y: ball.y,
                    vx: (Math.random() - 0.5) * 8,
                    vy: (Math.random() - 0.5) * 8,
                    life: 20,
                    color: '#c8ff00'
                });
            }
        }

        function resetBall(serverIsPlayer) {
            ball.x = serverIsPlayer ? 80 : canvas.width - 80;
            ball.y = serverIsPlayer ? player.y + PADDLE_HEIGHT / 2 : opponent.y + PADDLE_HEIGHT / 2;
            ball.vx = 0;
            ball.vy = 0;
            ball.serving = true;
            ball.serverIsPlayer = serverIsPlayer;

            // AI serves after a delay
            if (!serverIsPlayer) {
                setTimeout(() => {
                    if (ball.serving && !ball.serverIsPlayer && gameRunning) {
                        serveBall();
                    }
                }, 1000);
            }
        }

        function scorePoint(scorerIsPlayer) {
            if (scorerIsPlayer) {
                player.score++;
            } else {
                opponent.score++;
            }

            document.getElementById('scoreDisplay').textContent = `${player.score} - ${opponent.score}`;

            // Check for winner
            if (player.score >= WIN_SCORE || opponent.score >= WIN_SCORE) {
                endGame();
                return;
            }

            // Loser serves next
            resetBall(!scorerIsPlayer);
        }

        function update() {
            if (!gameRunning) return;

            // Player movement
            if (keys['ArrowUp']) {
                player.y -= player.speed;
            }
            if (keys['ArrowDown']) {
                player.y += player.speed;
            }

            // Keep player in bounds
            if (player.y < 0) player.y = 0;
            if (player.y > canvas.height - PADDLE_HEIGHT) player.y = canvas.height - PADDLE_HEIGHT;

            // Ball follows paddle during serve
            if (ball.serving) {
                if (ball.serverIsPlayer) {
                    ball.x = 80;
                    ball.y = player.y + PADDLE_HEIGHT / 2;
                } else {
                    ball.x = canvas.width - 80;
                    ball.y = opponent.y + PADDLE_HEIGHT / 2;
                }
            } else {
                // Move ball
                ball.x += ball.vx;
                ball.y += ball.vy;

                // Ball bounce off top/bottom
                if (ball.y <= BALL_SIZE / 2) {
                    ball.y = BALL_SIZE / 2;
                    ball.vy *= -1;
                    addBounceParticles(ball.x, ball.y);
                }
                if (ball.y >= canvas.height - BALL_SIZE / 2) {
                    ball.y = canvas.height - BALL_SIZE / 2;
                    ball.vy *= -1;
                    addBounceParticles(ball.x, ball.y);
                }

                // Player paddle collision
                if (ball.vx < 0 &&
                    ball.x - BALL_SIZE / 2 <= player.x + PADDLE_WIDTH &&
                    ball.x + BALL_SIZE / 2 >= player.x &&
                    ball.y >= player.y && ball.y <= player.y + PADDLE_HEIGHT) {

                    ball.x = player.x + PADDLE_WIDTH + BALL_SIZE / 2;

                    // Calculate angle based on where ball hit paddle
                    let hitPos = (ball.y - player.y) / PADDLE_HEIGHT;
                    let angle = (hitPos - 0.5) * Math.PI * 0.7;

                    // Power hit with space
                    let power = keys['Space'] ? 1.3 : 1;
                    let speed = Math.min(ball.speed * 1.05, 15) * power;

                    ball.vx = Math.cos(angle) * speed;
                    ball.vy = Math.sin(angle) * speed;
                    if (ball.vx < 3) ball.vx = 3;

                    ball.speed = Math.min(ball.speed * 1.02, 15);
                    rallyCount++;

                    addHitParticles(ball.x, ball.y, keys['Space']);
                }

                // Opponent paddle collision
                if (ball.vx > 0 &&
                    ball.x + BALL_SIZE / 2 >= opponent.x &&
                    ball.x - BALL_SIZE / 2 <= opponent.x + PADDLE_WIDTH &&
                    ball.y >= opponent.y && ball.y <= opponent.y + PADDLE_HEIGHT) {

                    ball.x = opponent.x - BALL_SIZE / 2;

                    let hitPos = (ball.y - opponent.y) / PADDLE_HEIGHT;
                    let angle = Math.PI - (hitPos - 0.5) * Math.PI * 0.7;

                    let speed = Math.min(ball.speed * 1.05, 15);
                    ball.vx = Math.cos(angle) * speed;
                    ball.vy = Math.sin(angle) * speed;
                    if (ball.vx > -3) ball.vx = -3;

                    ball.speed = Math.min(ball.speed * 1.02, 15);
                    rallyCount++;

                    addHitParticles(ball.x, ball.y, false);
                }

                // Score points
                if (ball.x < -BALL_SIZE) {
                    scorePoint(false);
                }
                if (ball.x > canvas.width + BALL_SIZE) {
                    scorePoint(true);
                }
            }

            // AI opponent movement
            let targetY = ball.y - PADDLE_HEIGHT / 2;
            let aiSpeed = opponent.speed;

            // Adjust AI based on difficulty
            if (difficulty === 'easy') {
                aiSpeed = 4;
                // AI reacts slowly
                if (ball.vx > 0) {
                    targetY = ball.y + ball.vy * 10 - PADDLE_HEIGHT / 2;
                }
            } else if (difficulty === 'medium') {
                aiSpeed = 5.5;
                if (ball.vx > 0) {
                    targetY = ball.y + ball.vy * 5 - PADDLE_HEIGHT / 2;
                }
            } else if (difficulty === 'hard') {
                aiSpeed = 7;
                // AI predicts ball position
                if (ball.vx > 0) {
                    let timeToReach = (opponent.x - ball.x) / ball.vx;
                    targetY = ball.y + ball.vy * timeToReach - PADDLE_HEIGHT / 2;
                }
            }

            // Add some randomness to AI
            targetY += Math.sin(Date.now() * 0.005) * 20;

            if (opponent.y + PADDLE_HEIGHT / 2 < targetY) {
                opponent.y += aiSpeed;
            } else if (opponent.y + PADDLE_HEIGHT / 2 > targetY) {
                opponent.y -= aiSpeed;
            }

            // Keep opponent in bounds
            if (opponent.y < 0) opponent.y = 0;
            if (opponent.y > canvas.height - PADDLE_HEIGHT) opponent.y = canvas.height - PADDLE_HEIGHT;

            // Update particles
            for (let i = particles.length - 1; i >= 0; i--) {
                particles[i].x += particles[i].vx;
                particles[i].y += particles[i].vy;
                particles[i].life--;
                if (particles[i].life <= 0) {
                    particles.splice(i, 1);
                }
            }
        }

        function addHitParticles(x, y, isPowerHit) {
            let count = isPowerHit ? 15 : 8;
            let color = isPowerHit ? '#ff0' : '#c8ff00';
            for (let i = 0; i < count; i++) {
                particles.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 10,
                    vy: (Math.random() - 0.5) * 10,
                    life: 15,
                    color: color
                });
            }
        }

        function addBounceParticles(x, y) {
            for (let i = 0; i < 5; i++) {
                particles.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 6,
                    vy: (Math.random() - 0.5) * 3,
                    life: 10,
                    color: '#fff'
                });
            }
        }

        function draw() {
            // Court background
            ctx.fillStyle = COURT_COLOR;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Court lines
            ctx.strokeStyle = LINE_COLOR;
            ctx.lineWidth = 3;

            // Border
            ctx.strokeRect(10, 10, canvas.width - 20, canvas.height - 20);

            // Center line
            ctx.setLineDash([10, 10]);
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, 10);
            ctx.lineTo(canvas.width / 2, canvas.height - 10);
            ctx.stroke();
            ctx.setLineDash([]);

            // Service boxes
            ctx.lineWidth = 2;
            ctx.strokeRect(10, canvas.height / 4, canvas.width / 4, canvas.height / 2);
            ctx.strokeRect(canvas.width - 10 - canvas.width / 4, canvas.height / 4, canvas.width / 4, canvas.height / 2);

            // Net
            ctx.fillStyle = '#fff';
            ctx.fillRect(canvas.width / 2 - 2, 0, 4, canvas.height);
            ctx.fillStyle = '#ccc';
            for (let y = 0; y < canvas.height; y += 20) {
                ctx.fillRect(canvas.width / 2 - 3, y, 6, 10);
            }

            // Particles
            for (const p of particles) {
                ctx.fillStyle = p.color;
                ctx.globalAlpha = p.life / 20;
                ctx.beginPath();
                ctx.arc(p.x, p.y, 4, 0, Math.PI * 2);
                ctx.fill();
            }
            ctx.globalAlpha = 1;

            // Player paddle
            ctx.fillStyle = '#00aaff';
            ctx.fillRect(player.x, player.y, PADDLE_WIDTH, PADDLE_HEIGHT);
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.strokeRect(player.x, player.y, PADDLE_WIDTH, PADDLE_HEIGHT);

            // Paddle grip
            ctx.fillStyle = '#0088cc';
            ctx.fillRect(player.x + 3, player.y + 10, PADDLE_WIDTH - 6, PADDLE_HEIGHT - 20);

            // Opponent paddle
            ctx.fillStyle = '#ff4444';
            ctx.fillRect(opponent.x, opponent.y, PADDLE_WIDTH, PADDLE_HEIGHT);
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.strokeRect(opponent.x, opponent.y, PADDLE_WIDTH, PADDLE_HEIGHT);

            // Paddle grip
            ctx.fillStyle = '#cc2222';
            ctx.fillRect(opponent.x + 3, opponent.y + 10, PADDLE_WIDTH - 6, PADDLE_HEIGHT - 20);

            // Ball
            ctx.fillStyle = '#c8ff00';
            ctx.shadowColor = '#c8ff00';
            ctx.shadowBlur = 15;
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, BALL_SIZE, 0, Math.PI * 2);
            ctx.fill();
            ctx.shadowBlur = 0;

            // Ball seam
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, BALL_SIZE - 2, 0, Math.PI * 2);
            ctx.stroke();

            // Serve indicator
            if (ball.serving && ball.serverIsPlayer) {
                ctx.fillStyle = '#fff';
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Press SPACE to serve!', canvas.width / 4, 40);
            }

            // Rally counter
            if (rallyCount > 2 && !ball.serving) {
                ctx.fillStyle = '#ffff00';
                ctx.font = 'bold 20px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(`Rally: ${rallyCount}`, canvas.width / 2, 40);
            }
        }

        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameOver').style.display = 'none';

            player.score = 0;
            opponent.score = 0;
            player.y = canvas.height / 2 - PADDLE_HEIGHT / 2;
            opponent.y = canvas.height / 2 - PADDLE_HEIGHT / 2;
            ball.speed = 7;
            particles = [];

            document.getElementById('scoreDisplay').textContent = '0 - 0';

            gameRunning = true;
            resetBall(true);
        }

        function endGame() {
            gameRunning = false;

            let winner = player.score >= WIN_SCORE ? 'You Win!' : 'Opponent Wins!';
            document.getElementById('winnerText').textContent = winner;
            document.getElementById('finalScoreText').textContent = `Final Score: ${player.score} - ${opponent.score}`;
            document.getElementById('gameOver').style.display = 'flex';
        }

        function backToMenu() {
            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('startScreen').style.display = 'flex';
        }

        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        gameLoop();
    </script>
</body>
</html>
